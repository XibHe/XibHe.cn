
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>石中剑</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="爱苹果,爱生活。">
<meta property="og:type" content="website">
<meta property="og:title" content="石中剑">
<meta property="og:url" content="http://XibHe.github.io/index.html">
<meta property="og:site_name" content="石中剑">
<meta property="og:description" content="爱苹果,爱生活。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="石中剑">
<meta name="twitter:description" content="爱苹果,爱生活。">
  
    <link rel="alternative" href="/atom.xml" title="石中剑" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon" type="image/x-ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">石中剑</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">It is never too late，Just do it better.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="XibHe.github.io">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main">
  
    <article id="post-记一个在使用Masonry时遇到的问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/18/记一个在使用Masonry时遇到的问题/" class="article-date">
  <time datetime="2016-09-18T12:35:34.000Z" itemprop="datePublished">2016-09-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/18/记一个在使用Masonry时遇到的问题/">记一个在使用Masonry时遇到的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="u4F7F_u7528Masonry_u7684_u573A_u666F"><a href="#u4F7F_u7528Masonry_u7684_u573A_u666F" class="headerlink" title="使用Masonry的场景"></a>使用Masonry的场景</h1><p>在“我的”界面顶部区域用来展示用户的登录信息，顶部有两种样式的变换，即，由未登录—-&gt;已登录。<br>如图所示，<br><img src="http://odchyrav4.bkt.clouddn.com/mine1.PNG?imageView/4/w/200/q/45" alt="IMG_3210"></p>
<p>其中头像区域是UIImageView，”登录/注册”是UILabel。登录成功后，头像区域会显示由服务器返回的头像地址生成的图片，并且其位置发生变化，不在居中显示，显示”登录/注册”的UILabel变为显示用户昵称，并且坐标位置发生改变。<br>如图所示，<br><img src="http://odchyrav4.bkt.clouddn.com/mine2.PNG?imageView/4/w/200/q/45" alt="已登录"></p>
<p>我的问题来了，在设置头像和标题位置时使用<strong>mas_remakeConstraints</strong>设置二者的约束，<br>代码如图，<br><img src="http://odchyrav4.bkt.clouddn.com/2016-09-18-QQ20160918-0@2x.png" alt="代码"></p>
<p>当从未登录切换到已登录时，已登录的头像位置会发生改变，变得特别大，不受约束控制。<br>控制台会报如下错误，<br><img src="http://odchyrav4.bkt.clouddn.com/2016-09-18-QQ20160918-1@2x.png" alt="报错"></p>
<p>刚开始没有意识到改变UIImageView的约束导致的新旧两种约束冲突造成的问题。在一个小时未解决该问题后，放弃了使用Masonry，改为使用代码做布局。今天，再回头看看这个问题，联想到忽略了什么东西，就打开Masonry文档从头开始仔细往下看，结果就看到了这句话，</p>
<blockquote>
<p>Sometimes you need modify existing constraints in order to animate or remove/replace constraints. In Masonry there are a few different approaches to updating constraints.</p>
</blockquote>
<p>文档上列举了三种修改现有约束的方法，</p>
<ol>
<li><p><strong>References</strong><br>你可以引用一个特定约束条件的约束，使表达式的结果分配给一个局部变量或一个类属性。</p>
</li>
<li><p><strong>mas_updateConstraints</strong><br>作为一种选择，如果你只是去更新固有的约束值，你可以使用<strong>mas_updateConstraints</strong>这种便利的方法替换<strong>mas_makeConstraints</strong>。</p>
</li>
<li><p><strong>mas_remakeConstraints</strong><br><strong>mas_updateConstraints</strong>用于更新一组约束，但要做那些费力的超出超出常量值的约束更新。这时就需要选择<strong>mas_remakeConstraints</strong>。<br><strong>mas_remakeConstraints</strong>类似于<strong>mas_updateConstraints</strong>，但它不是更新常量值，当再次为这些已经存在约束的视图设置约束前，它会移除掉该视图上的所有约束。这就让你可以为视图设置新的约束，而不用考虑移除之前已经存在的其他约束。</p>
</li>
</ol>
<p>于是，我使用文档中提到的第三种方法，将所有的<strong>mas_makeConstraints</strong>换成了<strong>mas_remakeConstraints</strong>，就解决了约束错乱的问题。</p>
<h1 id="u53C2_u8003_u6587_u6863"><a href="#u53C2_u8003_u6587_u6863" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://github.com/SnapKit/Masonry" target="_blank" rel="external">Masonry使用</a></p>
<p>造成这个问题的主要原因是我没有认真看Masonry的文档，文档上说的已经很清楚了。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://XibHe.github.io/2016/09/18/记一个在使用Masonry时遇到的问题/" data-id="ciwgbu3oh0001o3cqm1j5m1pl" class="article-share-link" data-share="baidu" data-title="记一个在使用Masonry时遇到的问题">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-记一个关于线程的错误" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/11/记一个关于线程的错误/" class="article-date">
  <time datetime="2016-09-11T15:23:34.000Z" itemprop="datePublished">2016-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/11/记一个关于线程的错误/">记一个关于线程的错误</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上周遇到一个问题，当前页面为一个UIWebView，当点该WebView上某个按钮进入下一个页面时，再通过该页面顶部返回按钮返回时，程序就会崩溃。（在开启了全局断点的情况下）控制台会输出如下提示：</p>
<p><img src="http://odchyrav4.bkt.clouddn.com/blog/image/997034A3-8246-4C63-A867-C968F2CCD96F.png" alt="控制台错误"></p>
<p>程序崩溃在将要消失时，控制台给出<font color="#FA8072"> This application is modifying the autolayout engine from a background thread,whinch can lead to engine corruption and weird crashes.This will cause an exception in a future release. </font> 的报错。</p>
<p>根据提示认为是后台线程在更新UI布局时，webView与JS的交互也在此时进行。交互操作会阻塞UI的显示及刷新。因此，又回到了一个老生常谈的准则上来了，<font color="#FA8072"> 要在主线程刷新UI布局 </font>。在调用本地应用于H5交互的方法时，要放到主线程中。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="preprocessor">#pragma mark - 跳转购物车</span></span><br><span class="line">- (<span class="keyword">void</span>)goCart:(<span class="built_in">NSString</span> *)shopNum</span><br><span class="line">&#123;</span><br><span class="line">    CLog(<span class="string">@"jsString = %@"</span>,shopNum);</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:ShopCartNumIsChanged object:shopNum];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [<span class="keyword">self</span><span class="variable">.navigationController</span> popToRootViewControllerAnimated:<span class="literal">NO</span>];</span><br><span class="line">        MallHomeViewController *mallHome = [LYSingle sharedSingle]<span class="variable">.mallVC</span>;</span><br><span class="line">        [mallHome setCurrentSelectIndex:<span class="number">3</span>];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma  mark - 商品上架(未开通店铺不能上架)</span></span><br><span class="line">- (<span class="keyword">void</span>)cannotShelves</span><br><span class="line">&#123;</span><br><span class="line">    CLog(<span class="string">@"cannotShelves"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIAlertView</span> *alertView = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:<span class="string">@""</span> message:<span class="string">@"要在主线程刷新UI"</span> delegate:<span class="keyword">self</span> cancelButtonTitle:<span class="string">@"我知道了"</span> otherButtonTitles:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [alertView show];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://XibHe.github.io/2016/09/11/记一个关于线程的错误/" data-id="ciwgbu3ok0002o3cq1m5awv47" class="article-share-link" data-share="baidu" data-title="记一个关于线程的错误">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-关于cocoapod的二三事" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/21/关于cocoapod的二三事/" class="article-date">
  <time datetime="2016-08-21T07:58:00.000Z" itemprop="datePublished">2016-08-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/21/关于cocoapod的二三事/">使用 cocoapods 时遇到的错误及错误的解决方案</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-The_dependency_AFNetworking__28_3D_2-6-3_29_is_not_used_in_any_concrete_target"><a href="#1-The_dependency_AFNetworking__28_3D_2-6-3_29_is_not_used_in_any_concrete_target" class="headerlink" title="1.The dependency AFNetworking (= 2.6.3) is not used in any concrete target."></a>1.The dependency <code>AFNetworking (= 2.6.3)</code> is not used in any concrete target.</h1><p>在cocoapods version 1.0 之后，默认生成的Podfile文件类似于</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">pod</span> <span class="string">'Alamofire'</span>, <span class="string">'~&gt; 3.1.4'</span></span><br><span class="line">pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.3.2'</span></span><br></pre></td></tr></table></figure>
<p>这样的默认设置。为了不发生如标题那样的错误，需要手动用 <font color="#FA8072"> target “TargetName” do end </font> 把需要 pod 的库包括进来。</p>
<figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">target <span class="variable">"TargetName"</span> <span class="keyword">do</span></span><br><span class="line">    pod <span class="string">'Alamofire'</span>, <span class="string">'~&gt; 3.1.4'</span></span><br><span class="line">    pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.3.2'</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="2-ios_None_of_your_spec_sources_contain_a_spec_satisfying_the_dependency_3A_IQKeyboardManager__28_7E_26gt_3B_4-0-0_29"><a href="#2-ios_None_of_your_spec_sources_contain_a_spec_satisfying_the_dependency_3A_IQKeyboardManager__28_7E_26gt_3B_4-0-0_29" class="headerlink" title="2.ios None of your spec sources contain a spec satisfying the dependency: IQKeyboardManager (~&gt; 4.0.0)."></a>2.ios None of your spec sources contain a spec satisfying the dependency: <code>IQKeyboardManager (~&gt; 4.0.0)</code>.</h1><p>报这个错误，可能是由于Cocoapods的配置库有损坏，Cocoapods建议删除本地副本重新clone。根据cocoapods官方博客的方案，在终端做出如下操作<font color="#FA8072"> (依照次序) </font></p>
<p>第一步:</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -fr ~<span class="regexp">/Library/</span><span class="constant">Caches</span>/<span class="constant">CocoaPods</span> &amp;&amp; \</span><br></pre></td></tr></table></figure>
<p>第二步:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo rm -fr ~/.cocoapods/repos/master</span><br><span class="line">gem <span class="operator"><span class="keyword">update</span> <span class="comment">--system &amp;&amp; \</span></span><br><span class="line">gem <span class="keyword">update</span> &amp;&amp; \</span><br><span class="line">gem <span class="keyword">cleanup</span> &amp;&amp; \</span><br><span class="line">pod setup</span></span><br></pre></td></tr></table></figure>
<h1 id="u53C2_u8003_u8D44_u6599"><a href="#u53C2_u8003_u8D44_u6599" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="http://stackoverflow.com/questions/34556991/pod-install-displaying-error-in-cocoapods-version-1-0-0-beta-1/34558516" target="_blank" rel="external">Pod install displaying error in cocoapods version 1.0.0.beta.1</a></p>
<p><a href="http://stackoverflow.com/questions/37624178/intergating-new-firebase-error-cocoapods" target="_blank" rel="external">intergating New Firebase.. error cocoapods</a></p>
<p><a href="http://stackoverflow.com/questions/38030317/pod-repo-update-does-not-happen-error-in-cocoapods" target="_blank" rel="external">pod repo update does not happen error in cocoapods</a></p>
<p><a href="http://blog.cocoapods.org/Repairing-Our-Broken-Specs-Repository/" target="_blank" rel="external">Repairing Our Broken Specs Repository</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://XibHe.github.io/2016/08/21/关于cocoapod的二三事/" data-id="ciwgbu3oo0004o3cqrjh445g9" class="article-share-link" data-share="baidu" data-title="使用 cocoapods 时遇到的错误及错误的解决方案">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-关于iOS 7 Background Remote Notification" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/09/关于iOS 7 Background Remote Notification/" class="article-date">
  <time datetime="2016-08-09T15:30:48.000Z" itemprop="datePublished">2016-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/09/关于iOS 7 Background Remote Notification/">关于iOS 7 Background Remote Notification(推送唤醒)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Background_Remote_Notification_u7B80_u4ECB"><a href="#Background_Remote_Notification_u7B80_u4ECB" class="headerlink" title="Background Remote Notification简介"></a>Background Remote Notification简介</h1><p>Remote Notifications是 iOS7 在推送方面最大的变化，它允许应用收到通知后在后台（background）状态下运行一段代码，可用于从服务器获取内容更新。功能使用场景：（多媒体）聊天，Email更新，基于通知的订阅内容同步等功能，提升了终端用户的体验。</p>
<h1 id="u5982_u4F55_u8BBE_u7F6ERemote_notifications"><a href="#u5982_u4F55_u8BBE_u7F6ERemote_notifications" class="headerlink" title="如何设置Remote notifications"></a>如何设置Remote notifications</h1><h3 id="u5BA2_u6237_u7AEF_u8BBE_u7F6E"><a href="#u5BA2_u6237_u7AEF_u8BBE_u7F6E" class="headerlink" title="客户端设置"></a>客户端设置</h3><p>需要在Xcode 中修改应用的 Capabilities 开启Remote notifications，如图：</p>
<p><img src="http://odchyrav4.bkt.clouddn.com/blog/image/Snip20131119_1.png" alt="客户端配置图"></p>
<p>当注册了Backgroud Modes -&gt; Remote notifications 后，notification 处理函数一律切换到下面函数，后台推送代码也在此函数中调用。</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="pp">- <span class="params">(void)</span>application:<span class="params">(<span class="variable">UIApplication</span> *)</span>application didReceiveRemoteNotification:<span class="params">(<span class="variable">NSDictionary</span> *)</span>userInfo fetchCompletionHandler:<span class="params">(void (^)</span><span class="params">(<span class="variable">UIBackgroundFetchResult</span>)</span>)completionHandler</span></span><br></pre></td></tr></table></figure>
<p>这个函数也是iOS8之后获取远程推送调用的方法。</p>
<h3 id="u670D_u52A1_u7AEF_u8BBE_u7F6E"><a href="#u670D_u52A1_u7AEF_u8BBE_u7F6E" class="headerlink" title="服务端设置"></a><font color="#FA8072"> 服务端设置 </font></h3><p>这个很重要，推送消息携带 content-available: 1 是Background 运行的必须参数，如果不携带此字段则与iOS7 之前版本的普通推送一样。<br>服务端payload格式:aps增加content-available字段，类似于：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload example:</span><br><span class="line">&#123;<span class="string">"aps"</span>:&#123;<span class="string">"alert"</span>:<span class="string">"example"</span>, <span class="string">"sound"</span>:<span class="string">"default"</span>, <span class="string">"badge"</span>: <span class="number">1</span>, <span class="string">"category"</span>:<span class="string">"reply"</span>,<span class="string">"content-available"</span>:<span class="string">"1"</span></span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>这里集成的是极光推送，参考极光推送 <font color="#FA8072"> Push API v3 </font>的文档，发现了iOS 平台上发送 APNS 通知的规范。其中支持的字段中关键字<font color="#FA8072"> content-available </font>的类型为 <font color="#FA8072"> boolean </font>。<br>如果该字段为<font color="#FA8072"> true </font> 说明是 <font color="#FA8072"> Background Remote Notification </font>，如果不携带此字段则是普通的<font color="#FA8072"> Remote Notification </font>。<br>这里需要特别注意的是服务器在配置<font color="#FA8072"> content-available: ture </font> 时的正确性。如图，后台以java为例。</p>
<font color="#DC143C" size="72"> 尚未传图 </font>

<p>最后，当应用在后台挂起时，发起一个<font color="#FA8072"> Background Remote Notification(推送唤醒) </font>。客户端获取的数据，如下:</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">userInfo = <span class="special">&#123;</span></span><br><span class="line">    "_j_msgid" = 2632357907;</span><br><span class="line">    aps =     <span class="special">&#123;</span></span><br><span class="line">        alert = "<span class="command">\U</span>6717<span class="command">\U</span>81f4<span class="command">\U</span>96c6<span class="command">\U</span>56e2<span class="command">\U</span>9738<span class="command">\U</span>5dde<span class="command">\U</span>5e02(<span class="command">\U</span>53bf<span class="command">\U</span>7ea7)<span class="command">\U</span>603b<span class="command">\U</span>4ee3<span class="command">\U</span>7406<span class="command">\U</span>5546<span class="command">\U</span>5bb6<span class="command">\U</span>60a8<span class="command">\U</span>597d<span class="command">\Uff</span>01<span class="command">\U</span>60a8<span class="command">\U</span>7684<span class="command">\U</span>5e97<span class="command">\U</span>94fa<span class="command">\U</span>53c8<span class="command">\U</span>6709<span class="command">\U</span>65b0<span class="command">\U</span>8ba2<span class="command">\U</span>5355<span class="command">\U</span>4e86<span class="command">\Uff</span>0c<span class="command">\U</span>8ba2<span class="command">\U</span>5355<span class="command">\U</span>53f73cef6682b73ca,<span class="command">\U</span>8bf7<span class="command">\U</span>53ca<span class="command">\U</span>65f6<span class="command">\U</span>767b<span class="command">\U</span>5f55<span class="command">\U</span>5546<span class="command">\U</span>57ce<span class="command">\U</span>8fdb<span class="command">\U</span>884c<span class="command">\U</span>8ba2<span class="command">\U</span>5355<span class="command">\U</span>5ba1<span class="command">\U</span>6838<span class="command">\U</span>3002";</span><br><span class="line">        badge = 1;</span><br><span class="line">        category = identifier;</span><br><span class="line">        sound = default;</span><br><span class="line">        content-available = 1;</span><br><span class="line">    <span class="special">&#125;</span>;</span><br><span class="line"><span class="special">&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="u53C2_u8003_u8D44_u6599"><a href="#u53C2_u8003_u8D44_u6599" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="http://docs.jiguang.cn/client/ios_tutorials/#ios-7-background-remote-notification" target="_blank" rel="external">极光客户端SDk教程</a></p>
<p><a href="http://docs.jiguang.cn/server/rest_api_v3_push/#notification" target="_blank" rel="external">极光服务器端Push API v3</a></p>
<p><a href="http://my.oschina.net/zhaodacai/blog/711368" target="_blank" rel="external">三种方式使得iOS应用能够在后台进行数据更新和下载</a></p>
<h1 id="u540E_u8BB0"><a href="#u540E_u8BB0" class="headerlink" title="后记"></a>后记</h1><p>关于<font color="#FA8072"> Background Remote Notification(推送唤醒) </font>早在一年前就使用过，当时调研调试花费了大量时间。没想到现在又遇到了这个问题。结果，我又在阴沟里翻了船。可见做笔记，写博客总结的重要性。希望第三次闭着眼睛就能跳过这个坑。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://XibHe.github.io/2016/08/09/关于iOS 7 Background Remote Notification/" data-id="ciwgbu3om0003o3cq7gfj0cc4" class="article-share-link" data-share="baidu" data-title="关于iOS 7 Background Remote Notification(推送唤醒)">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScriptCore与H5交互中使用JSExport设置引用名称空间" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/31/JavaScriptCore与H5交互中使用JSExport设置引用名称空间/" class="article-date">
  <time datetime="2016-07-31T07:13:34.000Z" itemprop="datePublished">2016-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/31/JavaScriptCore与H5交互中使用JSExport设置引用名称空间/">JavaScriptCore与H5交互中使用JSExport设置引用名称空间</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JavaScriptCore_u7B80_u4ECB"><a href="#JavaScriptCore_u7B80_u4ECB" class="headerlink" title="JavaScriptCore简介"></a>JavaScriptCore简介</h1><p>JavaScriptCore是iOS7引入的新功能，使用JavaScriptCore后可以实现js代码与本地native代码进行相互调用。</p>
<p>要使用JavaScriptCore，首先我们需要引入它的头文件 <code>#import &lt;JavaScriptCore/JavaScriptCore.h&gt;</code></p>
<p>这个头里面引入了几个重要的对象</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="id">#import</span> <span class="string">"JSContext.h"</span></span><br><span class="line"><span class="id">#import</span> <span class="string">"JSValue.h"</span></span><br><span class="line"><span class="id">#import</span> <span class="string">"JSManagedValue.h"</span></span><br><span class="line"><span class="id">#import</span> <span class="string">"JSVirtualMachine.h"</span></span><br><span class="line"><span class="id">#import</span> <span class="string">"JSExport.h"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>JSContext是JavaScript的运行上下文，他主要作用是执行js代码和注册native方法接口</li>
<li>JSValue是JSContext执行后的返回结果，他可以是任何js类型（比如基本数据类型和函数类型，对象类型等），并且都有对象的方法转换为native对象。</li>
<li>JSManagedValue是JSValue的封装，用它可以解决js和原声代码之间循环引用的问题</li>
<li>JSVirtualMachine 管理JS运行时和管理js暴露的native对象的内存</li>
<li>JSExport是一个协议，通过实现它可以完成把一个native对象暴漏给js</li>
</ul>
<p>具体的交互过程可以参见这篇博客<a href="https://imciel.com/2016/06/18/oc-js-communication/" target="_blank" rel="external">https://imciel.com/2016/06/18/oc-js-communication/</a></p>
<h1 id="u4F7F_u7528JSExport_u8BBE_u7F6E_u5F15_u7528_u540D_u79F0_u7A7A_u95F4"><a href="#u4F7F_u7528JSExport_u8BBE_u7F6E_u5F15_u7528_u540D_u79F0_u7A7A_u95F4" class="headerlink" title="使用JSExport设置引用名称空间"></a>使用JSExport设置引用名称空间</h1><p>js那边统一使用一个名为jsObject的对象来调用js的方法进行传值或触发某一特定的事件。在 js 中定义一个方法:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">title</span>&gt;</span>Demo<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="actionscript"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setContent</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        jsObject.shopCartNumChanged(totalNum);</span><br><span class="line">    &#125;    </span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">onload</span>=<span class="value">"javascript:setContent('ios is: ' + typeof ios)"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当点击 js 界面上的一个 “+” 号时，js 那边会查找 OC 代码通过JSContext注册的名为jsObject.shopCartNumChanged的调用方法。现在问题来了，在 OC 中该如何注册该方法呢?答案是使用语言穿梭机—JSExport协议。比如，我有一个<font color="#FA8072"> ShopCarViewController </font>的类。在.h中声明一个名为<font color="#FA8072"> MallJSExports </font>的协议。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ShopCarViewController.h</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;JavaScriptCore/JavaScriptCore.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MallJSExports</span> &lt;<span class="title">JSExport</span>&gt;</span></span><br><span class="line">- (<span class="keyword">void</span>)shopCartNumChanged:(<span class="built_in">NSString</span>*)shopNum;  <span class="comment">//购物车数量变化</span></span><br><span class="line">- (<span class="keyword">void</span>)orderGoBackToNative;                   <span class="comment">//订单返回按钮</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ShopCarViewController</span> : <span class="title">MallViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>在.m中当然要声明并实现该协议的方法。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ShopCarViewController</span>()&lt;<span class="title">UIWebViewDelegate</span>,<span class="title">MallJSExports</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIWebView</span> *webView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *shopNum;       <span class="comment">//商品数量</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ShopCarViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view.</span></span><br><span class="line">    <span class="keyword">self</span><span class="variable">.navigationItem</span><span class="variable">.title</span> = <span class="string">@"购物车"</span>;</span><br><span class="line"></span><br><span class="line">    _webView = [[<span class="built_in">UIWebView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, screenWidth, <span class="keyword">self</span><span class="variable">.view</span><span class="variable">.height</span>-<span class="number">49</span>)];</span><br><span class="line">    [_webView loadRequest:[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:_webUrl]]];</span><br><span class="line">    _webView<span class="variable">.delegate</span> = <span class="keyword">self</span>;</span><br><span class="line">    _webView<span class="variable">.detectsPhoneNumbers</span> = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:_webView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma mark - 在webView加载完成的代理方法里设置JSContext</span></span><br><span class="line">- (<span class="keyword">void</span>)webViewDidFinishLoad:(<span class="built_in">UIWebView</span> *)webView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//JS上下文对象</span></span><br><span class="line">    JSContext *context = [<span class="keyword">self</span><span class="variable">.webView</span> valueForKeyPath:<span class="string">@"documentView.webView.mainFrame.javaScriptContext"</span>];</span><br><span class="line">    context[<span class="string">@"jsObject"</span>] = <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma mark - 购物车数量变化</span></span><br><span class="line">- (<span class="keyword">void</span>)shopCartNumChanged:(<span class="built_in">NSString</span> *)shopNum</span><br><span class="line">&#123;</span><br><span class="line">    CLog(<span class="string">@"jsString shopNum = %@"</span>,shopNum);</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:ShopCartNumIsChanged object:shopNum];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma mark - 订单返回按钮</span></span><br><span class="line">- (<span class="keyword">void</span>)orderGoBackToNative</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.navigationController</span> popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里要注意的是<font color="#FA8072"> context[@ “jsObject” ] = self </font>中的的key值是和服务器商量好的, 即， js 中定义的回调方法<font color="#FA8072"> jsObject.shopCartNumChanged( )</font>相一致。</p>
<p>在这里对<font color="#FA8072"> JSExport </font>的使用只是简单的设置了一下命名空间，将下标方法暴露给js对象方便服务器调用。其实，<font color="#FA8072"> JSExport </font> 协议主要用途是把objc复杂对象转换成JSValue并暴露给js对象。<font color="#FA8072"> JSExport </font>作为两种语言的互通协议。<font color="#FA8072"> JSExport </font>中没有约定任何的方法，连可选的(@optional)都没有，但是所有继承了该协议(@protocol)的协议（注意不是Objective-C的类(@interface)）中定义的方法，都可以在JSContext中被使用。</p>
<h1 id="u53C2_u8003_u8D44_u6599"><a href="#u53C2_u8003_u8D44_u6599" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://imciel.com/2016/06/18/oc-js-communication/" target="_blank" rel="external">使用 JavaScriptCore 实现 JS和OC间的通信</a></p>
<p><a href="http://blog.iderzheng.com/ios7-objects-management-in-javascriptcore-framework/" target="_blank" rel="external">JavaScriptCore框架在iOS7中的对象交互和管理</a></p>
<p><a href="http://liuyanwei.jumppo.com/2016/04/03/iOS-JavaScriptCore.html" target="_blank" rel="external">iOS JavaScriptCore使用</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://XibHe.github.io/2016/07/31/JavaScriptCore与H5交互中使用JSExport设置引用名称空间/" data-id="ciwgbu3o40000o3cqqyftvzd0" class="article-share-link" data-share="baidu" data-title="JavaScriptCore与H5交互中使用JSExport设置引用名称空间">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-summary" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/16/summary/" class="article-date">
  <time datetime="2016-01-16T04:04:48.000Z" itemprop="datePublished">2016-01-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/16/summary/">路开始的地方</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="u7279_u522B_u9E23_u8C22"><a href="#u7279_u522B_u9E23_u8C22" class="headerlink" title="特别鸣谢"></a>特别鸣谢</h1><p>老郭，对本博客所提供的技术支持！<br>老郭，对本博客所提供的技术支持！<br>老郭，对本博客所提供的技术支持！<br>并附上他的博客<a href="http://imciel.com" target="_blank" rel="external">地址</a></p>
<h1 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h1><p>博客页面的搭建是在2015年6月15日，在老郭的指导下完成的。搭建博客的初衷完全是因为看到别人都有博客，而且界面很炫，为了自己的虚荣心才觉得自己也要整一个这样的博客。可是等到自己动手的时候，完全无从下手。什么是<a href="https://hexo.io/zh-cn/docs/helpers.html" target="_blank" rel="external">Hexo</a>，<a href="http://brew.sh" target="_blank" rel="external">Homebrew</a>，<a href="http://wowubuntu.com/markdown/#list" target="_blank" rel="external">MarkDown</a>等等。这些都没有听说过。还好有老郭，他手把手的教我如何去配置这些东东。那时候觉得自己好2B。最后，倒是整出来了，看到了久违的Hello World，还是当年的配方，还是熟悉的味道。<br>好吧，我承认我只是一时的冲动和虚荣心在作怪，我的博客在2015年6月15日止步于Hello World，从此，再也没有爬起来过。</p>
<blockquote>
<p>自己思考原来就是件很快乐的事情，而教别人思考则是学习思考，锻炼思维的最好办法。</p>
</blockquote>
<h1 id="u4E3A_u4EC0_u4E48_u5199_u535A_u5BA2"><a href="#u4E3A_u4EC0_u4E48_u5199_u535A_u5BA2" class="headerlink" title="为什么写博客"></a>为什么写博客</h1><p>或许我并不是一个喜欢记录，总结的人。但还是因为工作的原因(每个周五都要发一份周报给老大)，还是养成了一个记录的习惯。我把周一到周五每天都做了什么事情，记录在一个黑色的笔记本上。 把那些未经整理的，杂乱无章的，解决的问题的过程和代码复制到了印象笔记上。以备以后查阅方便。遇到类似的问题就打开笔记，复制出一份代码。也未深究这段代码的意义何在，为什么可以解决问题。久而久之，便不会思考，真的就成为了代码的搬运工了。没有了思考，发现不了自己的短板，便陷在了这样一种自我满足的境地当中了。每天看似在前进，实际上是在原地绕弯。日复一日，剩下的只有惶恐和迷茫。变得越来越不自信。杂乱无章的笔记和随处存放的代码片段并不能引导我去思考制造这些Bug的原因。我要思考，要分享我的思考过程，希望得到别人认可的同时也能指出我的不足和错误。</p>
<blockquote>
<p>解决问题的核心思想只有一个———一切都靠积累。</p>
</blockquote>
<h1 id="u535A_u5BA2_u7684_u5F00_u59CB"><a href="#u535A_u5BA2_u7684_u5F00_u59CB" class="headerlink" title="博客的开始"></a>博客的开始</h1><p>回顾过去的2015年，我已经在新公司待了快一年了，虽然，不知道自己究竟都有哪些提升。但是，冥冥中又觉得自己还是有些收获的。当然这些收获都来自于师傅他老人家的谆谆教导。我不想忘记那些和师傅一起加班的日日夜夜里所带来的收获，我要把这些冥冥中的收获写下来，记录我在这些项目中的收获，以及那些尚未解决的问题所留下的遗憾。 期望以后能弥补这些遗憾。留住这些青春的记忆。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://XibHe.github.io/2016/01/16/summary/" data-id="ciwgbu3oq0005o3cqa9krox8c" class="article-share-link" data-share="baidu" data-title="路开始的地方">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
  
</section>
      
      <aside id="sidebar">
  
    
  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/09/18/记一个在使用Masonry时遇到的问题/">记一个在使用Masonry时遇到的问题</a>
          </li>
        
          <li>
            <a href="/2016/09/11/记一个关于线程的错误/">记一个关于线程的错误</a>
          </li>
        
          <li>
            <a href="/2016/08/21/关于cocoapod的二三事/">使用 cocoapods 时遇到的错误及错误的解决方案</a>
          </li>
        
          <li>
            <a href="/2016/08/09/关于iOS 7 Background Remote Notification/">关于iOS 7 Background Remote Notification(推送唤醒)</a>
          </li>
        
          <li>
            <a href="/2016/07/31/JavaScriptCore与H5交互中使用JSExport设置引用名称空间/">JavaScriptCore与H5交互中使用JSExport设置引用名称空间</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://xiguabaobao.com" target="_blank">主题作者</a>
          </li>
        
          <li>
            <a href="http://reqianduan.com" target="_blank">热前端</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 XibHe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js" type="text/javascript"></script>

</div>
</body>
</html>
